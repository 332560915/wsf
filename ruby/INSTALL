Installing WSO2 WSF/Ruby
========================

INSTALLATION
------------

Common configurations (Both Linux and windows)
-------------------------

- Before Install WSO2 WSF/Ruby, following configuration entries have to be added
  to the 'rbconfig.rb' that shift with ruby package.
  (under windows use '/' or '\\' to to seperate directories.
   e.g. "E:/install/wsfc" or "E:\\install\\wsfc")
  
  CONFIG["WSFC_HOME"] = "/your/wsfc/home/"
  CONFIG["WSF_LOG_DIR"] = "/where/the/log/files/should/reside/"
  CONFIG["WSF_LOG_LEVEL"] = "3"
    
    Valid Log Levels - 
          "0" - CRITICAL
          "1" - ERROR
          "2" - WARNING
          "3" - INFO
          "4" - DEBUG
          "5" - TRACE

    NOTE : run "ruby find_rbconfig.rb" in a console to find where this file is.


Linux
----- 
1. Run "sh build.sh" to setup the extension.  You may require super user 
   privileges to run build.sh

Windows
-------
Source Distribution
-------------------
1. Comment the following 3 lines at the top of config.h file. 
 
   #if _MSC_VER != 1200
   #error MSC version unmatch
   #endif

   NOTE : run "ruby find_config_h.rb" in a console to find where this file is.

2. Make sure the WSFC_HOME/lib directory is added to the PATH environment variable.

3. If you have the Visual Studio command prompt installed on your computer, 
   open it.

4. If you don't have the Visual Studio command prompt installed on your computer, 
   open a command prompt and run vcvars32.bat.

5. Go to the WSO2 WSF/Ruby source directory

6. Run build.bat file in the WSO2 WSF/Ruby source directory.


Binary Distribution
-------------------
1. How to setup WSF/Ruby on Windows

    a. Requirements

    You need to download following dependency libraries:

    libxml2 binary distribution   
    iconv binary distribution
    OpenSSL binary distribution
    Ruby Binary (One click installer is prefereble)
    Mysql Server 5 [When using Reliable Messaging With MySql Database ]

    In addition you need to have visual studio installed on your system.
    
    obtain libxml2 and iconv win32 binaries from [1].
    obtain OpenSSL binary from [2] [the build system assumes that you install openssl from msi].
    obtain MySql Server from [3].
    obtain Ruby Bianry from [4].

    [1] http://www.zlatkovic.com/pub/libxml/
    [2] http://www.slproweb.com/products/Win32OpenSSL.html
    [3] http://dev.mysql.com/downloads/
    [4] http://www.ruby-lang.org/en/downloads/
        
2. Installing Ruby extension.

    You should have the wso2-wsf-ruby binary pack with following structure.

    wso2-wsf-ruby-bin-1.0.0-win32
                |  
                +-- wsf_c
                |
                +-- doc
                |
                +-- samples
                |
                +-- lib
     
    1. Include <wso2-wsf-ruby-binary-dir>/wsf_c/lib to windows PATH variable. 

    2. Execute install.rb file. (run "ruby install.rb" without quotes)
    
    3. Add the following entries to your rbconfig.rb file which is in your ruby installation location.

       (use '/' to seperate directories. e.g. "E:/install/wsfc")
  
          CONFIG["WSFC_HOME"] = "/your/wsfc/home/"
          CONFIG["WSF_LOG_DIR"] = "/where/the/log/files/should/reside/"
          CONFIG["WSF_LOG_LEVEL"] = "3"
    
       Valid Log Levels - 
              "0" - CRITICAL
              "1" - ERROR
              "2" - WARNING
              "3" - INFO
              "4" - DEBUG
              "5" - TRACE
    
            NOTE : run "ruby find_rbconfig.rb" in a console to find where this file is.
               
    4. Now you should be able to run the samples in samples directory. 
                                      
3. Binary Dependency version numbers.

  WSO2-WSF-Ruby-1.0.0 Win32 Binary Will be compiled using following version of dependency libraries.

  1. Ruby    1.8.6
  2. Libxml2 2.6.30
  3. Iconv   1.9.2 
  4. openssl .98d (MSI)

RUN SAMPLES
-----------
1. It is required to have Rails Framework installed in your machine to run 
   the Rails samples in
     - samples/consumer/rails and
	 - samples/provider

2. To deploy the echo service sample follow the README in the samples/provider
   directory.

3. Then go to the samples/consumer directory and open the echo_client.rb and 
   change the constant END_POINT to your service endpoint.
   
4. Then run the sample by typing ruby echo_client.rb in command line or terminal.
   If your client and service working fine, You will see the 'SUCCESSFUL' message 

5. You may deploy the echo service in WSO2 WSF/C to run
   consumer samples. Remember to change the END_POINT constants to the service
   end point addresses before running clients.


